<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitScan - GitHub Profile Scanner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .profile-card {
            transition: all 0.3s ease;
        }
        .repo-card {
            transition: all 0.3s ease;
        }
        .repo-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .download-btn {
            transition: all 0.2s ease;
        }
        .download-btn:hover {
            transform: scale(1.05);
        }
        .loading-spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 3px solid #3b82f6;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .search-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .search-input-wrapper {
            position: relative;
            flex: 1;
        }
        .clear-btn {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            color: #9ca3af;
            cursor: pointer;
            display: none;
        }
        .clear-btn:hover {
            color: #6b7280;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 min-h-screen flex flex-col">
    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-10">
        <div class="container mx-auto px-4 py-4">
            <div class="flex flex-col sm:flex-row items-center justify-between gap-4">
                <div class="flex items-center space-x-3">
                    <i class="fab fa-github text-blue-500 text-4xl"></i>
                    <h1 class="text-3xl font-bold">GitScan</h1>
                </div>
                <div class="search-container w-full sm:w-96">
                    <div class="search-input-wrapper">
                        <input 
                            type="text" 
                            id="usernameInput" 
                            placeholder="Enter GitHub username" 
                            class="px-4 py-2 pr-8 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-300 w-full"
                        >
                        <i class="fas fa-times clear-btn" id="clearBtn"></i>
                    </div>
                    <button 
                        id="searchBtn" 
                        class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition whitespace-nowrap"
                    >
                        Search
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-6 flex-grow">
        <!-- Initial State -->
        <div id="initialState" class="text-center py-12">
            <i class="fab fa-github text-6xl text-gray-300 mb-4"></i>
            <h2 class="text-2xl font-bold text-gray-700 mb-2">GitHub Profile Scanner</h2>
            <p class="text-gray-600 max-w-md mx-auto">Search for any GitHub profile to view details, repositories, and download data.</p>
        </div>

        <!-- Loading State -->
        <div id="loadingState" class="hidden text-center py-12">
            <div class="loading-spinner mx-auto mb-4"></div>
            <p class="text-gray-600">Fetching GitHub data...</p>
        </div>

        <!-- Error State -->
        <div id="errorState" class="hidden text-center py-12">
            <i class="fas fa-exclamation-circle text-5xl text-red-400 mb-4"></i>
            <h2 class="text-xl font-bold text-gray-700 mb-2">Profile Not Found</h2>
            <p class="text-gray-600 mb-4">The GitHub username you entered doesn't exist or is private.</p>
            <button id="tryAgainBtn" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition">
                Try Again
            </button>
        </div>

        <!-- Profile Section -->
        <div id="profileSection" class="hidden">
            <div class="bg-white rounded-lg shadow p-6 mb-6 profile-card">
                <div class="flex flex-col md:flex-row items-center md:items-start gap-6">
                    <div class="flex-shrink-0">
                        <img id="profileAvatar" src="" alt="Profile Avatar" class="w-32 h-32 rounded-full border-4 border-white shadow-lg">
                    </div>
                    <div class="flex-grow text-center md:text-left">
                        <h2 id="profileName" class="text-2xl font-bold mb-1"></h2>
                        <p id="profileUsername" class="text-gray-600 mb-3"></p>
                        <div class="flex flex-wrap justify-center md:justify-start gap-4 mb-4">
                            <div class="flex items-center">
                                <i class="fas fa-users text-gray-500 mr-2"></i>
                                <span id="profileFollowers"></span> followers
                            </div>
                            <div class="flex items-center">
                                <i class="fas fa-user-friends text-gray-500 mr-2"></i>
                                <span id="profileFollowing"></span> following
                            </div>
                            <div class="flex items-center">
                                <i class="fas fa-book text-gray-500 mr-2"></i>
                                <span id="profileRepos"></span> repositories
                            </div>
                        </div>
                    </div>
                    <div class="flex flex-col gap-2">
                        <button id="downloadAvatarBtn" class="download-btn px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition">
                            <i class="fas fa-download mr-2"></i>Download Avatar
                        </button>
                        <button id="downloadDataBtn" class="download-btn px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition">
                            <i class="fas fa-file-download mr-2"></i>Download All Data
                        </button>
                    </div>
                </div>
            </div>

            <!-- Repositories Section -->
            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-bold">Repositories</h3>
                    <div class="text-sm text-gray-600">
                        <span id="repoCount"></span> repositories
                    </div>
                </div>
                <div id="reposList" class="space-y-4">
                    <!-- Repositories will be loaded here -->
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-white mt-8 py-6 border-t">
        <div class="container mx-auto px-4 text-center text-sm text-gray-600">
            <p>Made with ❤️ by Sauravhhh</p>
        </div>
    </footer>

    <script>
        // Global variables
        let userData = {};
        let userRepos = [];
        
        // DOM elements
        const elements = {
            usernameInput: document.getElementById('usernameInput'),
            clearBtn: document.getElementById('clearBtn'),
            searchBtn: document.getElementById('searchBtn'),
            tryAgainBtn: document.getElementById('tryAgainBtn'),
            initialState: document.getElementById('initialState'),
            loadingState: document.getElementById('loadingState'),
            errorState: document.getElementById('errorState'),
            profileSection: document.getElementById('profileSection'),
            profileAvatar: document.getElementById('profileAvatar'),
            profileName: document.getElementById('profileName'),
            profileUsername: document.getElementById('profileUsername'),
            profileFollowers: document.getElementById('profileFollowers'),
            profileFollowing: document.getElementById('profileFollowing'),
            profileRepos: document.getElementById('profileRepos'),
            downloadAvatarBtn: document.getElementById('downloadAvatarBtn'),
            downloadDataBtn: document.getElementById('downloadDataBtn'),
            reposList: document.getElementById('reposList'),
            repoCount: document.getElementById('repoCount')
        };

        // Event listeners
        elements.searchBtn.addEventListener('click', searchUser);
        elements.tryAgainBtn.addEventListener('click', resetToInitialState);
        elements.downloadAvatarBtn.addEventListener('click', downloadAvatar);
        elements.downloadDataBtn.addEventListener('click', downloadAllData);
        elements.usernameInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchUser();
            }
        });
        elements.usernameInput.addEventListener('input', function() {
            // Show/hide clear button based on input value
            if (this.value.trim() !== '') {
                elements.clearBtn.style.display = 'block';
            } else {
                elements.clearBtn.style.display = 'none';
            }
        });
        elements.clearBtn.addEventListener('click', function() {
            elements.usernameInput.value = '';
            elements.clearBtn.style.display = 'none';
            elements.usernameInput.focus();
        });

        // Functions
        function searchUser() {
            const username = elements.usernameInput.value.trim();
            if (!username) return;

            showLoadingState();
            
            // Fetch user data
            fetch(`https://api.github.com/users/${username}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('User not found');
                    }
                    return response.json();
                })
                .then(data => {
                    userData = data;
                    return fetch(`https://api.github.com/users/${username}/repos?per_page=100`);
                })
                .then(response => response.json())
                .then(repos => {
                    userRepos = repos;
                    displayUserData();
                    displayUserRepos();
                })
                .catch(error => {
                    console.error('Error:', error);
                    showErrorState();
                });
        }

        function showLoadingState() {
            elements.initialState.classList.add('hidden');
            elements.errorState.classList.add('hidden');
            elements.profileSection.classList.add('hidden');
            elements.loadingState.classList.remove('hidden');
        }

        function showErrorState() {
            elements.loadingState.classList.add('hidden');
            elements.errorState.classList.remove('hidden');
        }

        function resetToInitialState() {
            elements.errorState.classList.add('hidden');
            elements.profileSection.classList.add('hidden');
            elements.initialState.classList.remove('hidden');
            elements.usernameInput.value = '';
            elements.clearBtn.style.display = 'none';
            elements.usernameInput.focus();
        }

        function displayUserData() {
            elements.loadingState.classList.add('hidden');
            elements.profileSection.classList.remove('hidden');
            
            // Set profile data
            elements.profileAvatar.src = userData.avatar_url;
            elements.profileName.textContent = userData.name || userData.login;
            elements.profileUsername.textContent = `@${userData.login}`;
            elements.profileFollowers.textContent = userData.followers;
            elements.profileFollowing.textContent = userData.following;
            elements.profileRepos.textContent = userData.public_repos;
            
            // Update repo count with space
            elements.repoCount.textContent = userRepos.length;
        }

        function displayUserRepos() {
            if (userRepos.length === 0) {
                elements.reposList.innerHTML = `
                    <div class="text-center py-8 text-gray-500">
                        <i class="fas fa-folder-open text-3xl mb-2"></i>
                        <p>No repositories</p>
                    </div>
                `;
                return;
            }
            
            elements.reposList.innerHTML = userRepos.map(repo => {
                const language = repo.language || 'Unknown';
                const languageColor = getLanguageColor(language);
                
                return `
                    <div class="repo-card border rounded-lg p-4">
                        <div class="flex justify-between items-start">
                            <div>
                                <h4 class="font-bold text-lg mb-1">
                                    <a href="${repo.html_url}" target="_blank" class="text-blue-500 hover:underline">
                                        ${repo.name}
                                    </a>
                                </h4>
                                <p class="text-gray-600 text-sm mb-3">${repo.description || 'No description'}</p>
                                <div class="flex flex-wrap gap-3 text-sm">
                                    <div class="flex items-center">
                                        <span class="w-3 h-3 rounded-full mr-1" style="background-color: ${languageColor}"></span>
                                        <span>${language}</span>
                                    </div>
                                    <div class="flex items-center">
                                        <i class="fas fa-star text-yellow-500 mr-1"></i>
                                        <span>${repo.stargazers_count}</span>
                                    </div>
                                    <div class="flex items-center">
                                        <i class="fas fa-code-branch text-gray-500 mr-1"></i>
                                        <span>${repo.forks_count}</span>
                                    </div>
                                    <div class="flex items-center">
                                        <i class="fas fa-exclamation-circle text-gray-500 mr-1"></i>
                                        <span>${repo.open_issues_count}</span>
                                    </div>
                                </div>
                            </div>
                            <a href="${repo.html_url}/archive/refs/heads/${repo.default_branch || 'main'}.zip" 
                               class="download-btn px-3 py-1 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition text-sm"
                               download>
                                <i class="fas fa-download mr-1"></i>ZIP
                            </a>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function getLanguageColor(language) {
            const colors = {
                'JavaScript': '#f1e05a',
                'TypeScript': '#3178c6',
                'Python': '#3572A5',
                'Java': '#b07219',
                'C#': '#239120',
                'PHP': '#4F5D95',
                'C++': '#f34b7d',
                'Go': '#00ADD8',
                'Ruby': '#701516',
                'Swift': '#ffac45',
                'Kotlin': '#F18E33',
                'Rust': '#dea584',
                'HTML': '#e34c26',
                'CSS': '#563d7c',
                'Unknown': '#9ca3af'
            };
            return colors[language] || colors['Unknown'];
        }

        function downloadAvatar() {
            // Create a new image element to ensure the image is loaded
            const img = new Image();
            img.crossOrigin = 'anonymous';
            img.onload = function() {
                // Create canvas to convert image to blob
                const canvas = document.createElement('canvas');
                canvas.width = img.width;
                canvas.height = img.height;
                const ctx = canvas.getContext('2d');
                ctx.drawImage(img, 0, 0);
                
                // Convert to blob and download
                canvas.toBlob(function(blob) {
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `${userData.login}-avatar.jpg`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                }, 'image/jpeg', 0.95);
            };
            img.src = userData.avatar_url;
        }

        function downloadAllData() {
            const allData = {
                profile: userData,
                repositories: userRepos
            };
            
            const dataStr = JSON.stringify(allData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `${userData.login}-github-data.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            document.body.appendChild(linkElement);
            linkElement.click();
            document.body.removeChild(linkElement);
        }
    </script>
</body>
</html>
